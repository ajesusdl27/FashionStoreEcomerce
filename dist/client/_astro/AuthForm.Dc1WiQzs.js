import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.WFquGv8Z.js";import{s as S}from"./supabase.CvUDO22r.js";function T({mode:m,redirectTo:f="/cuenta"}){const[c,y]=s.useState(""),[n,v]=s.useState(""),[p,w]=s.useState(""),[g,j]=s.useState(""),[h,a]=s.useState(!1),[x,t]=s.useState(""),[b,l]=s.useState(""),i=m==="register",N=m==="admin-login",C=async r=>{r.preventDefault(),t(""),l(""),a(!0);try{if(i){if(n!==p){t("Las contraseñas no coinciden"),a(!1);return}if(n.length<6){t("La contraseña debe tener al menos 6 caracteres"),a(!1);return}const{data:o,error:d}=await S.auth.signUp({email:c,password:n,options:{data:{full_name:g}}});if(d){t(d.message),a(!1);return}o.session?(await fetch("/api/auth/set-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({access_token:o.session.access_token,refresh_token:o.session.refresh_token})})).ok?(l("¡Cuenta creada! Redirigiendo..."),setTimeout(()=>{window.location.href=f},1500)):t("Error al establecer la sesión"):l("¡Revisa tu email para confirmar tu cuenta!")}else{const o=new FormData;o.append("email",c),o.append("password",n),o.append("redirectTo",N?"/admin":f);const d=await fetch("/api/auth/login",{method:"POST",body:o}),u=await d.json();if(!d.ok){t(u.error||"Error al iniciar sesión"),a(!1);return}l("¡Bienvenido! Redirigiendo..."),setTimeout(()=>{window.location.href=u.redirectTo},1e3)}}catch{t("Error de conexión. Inténtalo de nuevo.")}finally{a(!1)}};return e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[i&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-muted-foreground mb-2",children:"Nombre completo"}),e.jsx("input",{type:"text",id:"name",value:g,onChange:r=>j(r.target.value),required:!0,className:`w-full px-4 py-3 bg-card border border-border rounded-lg text-foreground transition-all duration-300\r
              placeholder:text-muted-foreground\r
              focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary\r
              hover:border-muted-foreground`,placeholder:"Tu nombre"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-muted-foreground mb-2",children:["Email ",e.jsx("span",{className:"text-accent",children:"*"})]}),e.jsx("input",{type:"email",id:"email",value:c,onChange:r=>y(r.target.value),required:!0,className:`w-full px-4 py-3 bg-card border border-border rounded-lg text-foreground transition-all duration-300\r
            placeholder:text-muted-foreground\r
            focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary\r
            hover:border-muted-foreground`,placeholder:"tu@email.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"password",className:"block text-sm font-medium text-muted-foreground mb-2",children:["Contraseña ",e.jsx("span",{className:"text-accent",children:"*"})]}),e.jsx("input",{type:"password",id:"password",value:n,onChange:r=>v(r.target.value),required:!0,minLength:6,className:`w-full px-4 py-3 bg-card border border-border rounded-lg text-foreground transition-all duration-300\r
            placeholder:text-muted-foreground\r
            focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary\r
            hover:border-muted-foreground`,placeholder:"••••••••"})]}),i&&e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-muted-foreground mb-2",children:["Confirmar contraseña ",e.jsx("span",{className:"text-accent",children:"*"})]}),e.jsx("input",{type:"password",id:"confirmPassword",value:p,onChange:r=>w(r.target.value),required:!0,minLength:6,className:`w-full px-4 py-3 bg-card border border-border rounded-lg text-foreground transition-all duration-300\r
              placeholder:text-muted-foreground\r
              focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary\r
              hover:border-muted-foreground`,placeholder:"••••••••"})]}),x&&e.jsx("div",{className:"p-4 bg-accent/10 border border-accent/50 rounded-lg text-accent text-sm animate-fade-in",children:x}),b&&e.jsx("div",{className:"p-4 bg-primary/10 border border-primary/50 rounded-lg text-primary text-sm animate-fade-in",children:b}),e.jsx("button",{type:"submit",disabled:h,className:`w-full inline-flex items-center justify-center font-heading tracking-wider\r
          px-6 py-4 text-base\r
          bg-primary text-primary-foreground \r
          hover:shadow-[0_0_20px_rgba(204,255,0,0.4)] hover:scale-[1.02]\r
          active:scale-[0.98]\r
          transition-all duration-300 touch-target\r
          focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary\r
          disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100`,children:h?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i?"Registrando...":"Iniciando sesión..."]}):i?"CREAR CUENTA":"INICIAR SESIÓN"})]})}export{T as default};
