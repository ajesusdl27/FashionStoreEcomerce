---
import AdminLayout from "@/layouts/AdminLayout.astro";
import { createAuthenticatedClient } from "@/lib/supabase";
import {
  getMonthlyRevenue,
  getPendingOrders,
  getBestSellingProduct,
  getSalesLast7Days,
  getDashboardExtendedMetrics,
} from "@/lib/analytics";
import { formatPrice } from "@/lib/formatters";
import { getSettings } from "@/lib/settings";

// React Island Components
import KPICard from "@/components/islands/KPICard";
import SalesChart from "@/components/islands/SalesChart";
import DoughnutChart from "@/components/islands/DoughnutChart";
import DashboardRefreshButton from "@/components/islands/DashboardRefreshButton";
import InlineStockEditor from "@/components/islands/admin/InlineStockEditor";
import ReturnsWidget from "@/components/islands/admin/ReturnsWidget";
import {
  Star,
  ShoppingBag,
  ChevronRight,
  AlertTriangle,
  CheckCircle,
  Plus,
  FileText,
  Settings,
  Mail,
  RotateCcw,
  Ticket,
  Truck,
  Package,
  Tag,
} from "lucide-react";

// Get authenticated client for RLS compliance
const accessToken = Astro.cookies.get("sb-access-token")?.value;
const refreshToken = Astro.cookies.get("sb-refresh-token")?.value;
const authClient = createAuthenticatedClient(accessToken, refreshToken);

// Get dynamic low stock threshold from settings
const storeSettings = await getSettings();
const lowStockThreshold = storeSettings.lowStockThreshold;

// Server render timestamp for refresh button
const renderTime = new Date().toISOString();

// Timezone handling for Spain
function getSpainMidnightUTC(): Date {
  const now = new Date();
  const spainTimeStr = now.toLocaleString("en-US", {
    timeZone: "Europe/Madrid",
    year: "numeric",
    month: "2-digit",
    day: "2-digit",
    hour: "2-digit",
    minute: "2-digit",
    second: "2-digit",
    hour12: false,
  });
  const [datePart] = spainTimeStr.split(", ");
  const parts = datePart?.split("/") ?? [];
  const [month = "01", day = "01", year = "2024"] = parts;
  const spainDate = new Date(`${year}-${month}-${day}T00:00:00Z`);
  const spainOffset = new Date()
    .toLocaleString("en-US", { timeZone: "Europe/Madrid", timeZoneName: "short" })
    .includes("GMT+2") ? 2 : 1;
  spainDate.setUTCHours(0 - spainOffset);
  return spainDate;
}

const todaySpainMidnight = getSpainMidnightUTC();
const todayUTC = todaySpainMidnight.toISOString();
const yesterdaySpainMidnight = new Date(todaySpainMidnight);
yesterdaySpainMidnight.setUTCDate(yesterdaySpainMidnight.getUTCDate() - 1);
const yesterdayUTC = yesterdaySpainMidnight.toISOString();

// === Parallelized first-pass queries ===
const [
  { count: ordersToday },
  { count: ordersYesterday },
  { data: lowStockVariants },
  { data: recentOrders },
  { data: rawReturns },
] = await Promise.all([
  authClient.from("orders").select("*", { count: "exact", head: true }).gte("created_at", todayUTC),
  authClient.from("orders").select("*", { count: "exact", head: true }).gte("created_at", yesterdayUTC).lt("created_at", todayUTC),
  authClient.from("product_variants")
    .select(`id, size, stock, product:products(id, name)`)
    .lt("stock", lowStockThreshold)
    .order("stock", { ascending: true })
    .limit(8),
  authClient.from("orders").select("*").order("created_at", { ascending: false }).limit(5),
  authClient.from("returns")
    .select(`id, status, refund_amount, created_at, order:orders(id, customer_name)`)
    .order("created_at", { ascending: false })
    .limit(5),
]);

// Normalize Supabase joined returns (order comes as array)
const recentReturns = (rawReturns || []).map((r: any) => ({
  ...r,
  order: Array.isArray(r.order) ? r.order[0] || null : r.order,
}));

// === Analytics fetch ===
let analytics: any = null;
let extendedMetrics: any = null;
try {
  const [monthlyRevenue, pendingOrders, bestSelling, sales7Days] = await Promise.all([
    getMonthlyRevenue(authClient),
    getPendingOrders(authClient),
    getBestSellingProduct(authClient),
    getSalesLast7Days(authClient),
  ]);

  analytics = { monthlyRevenue, pendingOrders, bestSelling, sales7Days };

  // Extended metrics (uses monthly data for AOV calculation)
  extendedMetrics = await getDashboardExtendedMetrics(
    authClient,
    monthlyRevenue.orderCount,
    monthlyRevenue.total,
  );
} catch (error) {
  console.error("Analytics error:", error);
}

// === Helpers ===
const formatDate = (date: string) => {
  return new Date(date).toLocaleDateString("es-ES", {
    day: "2-digit",
    month: "short",
    hour: "2-digit",
    minute: "2-digit",
  });
};

const statusConfig: Record<string, { label: string; class: string }> = {
  pending: { label: "Pendiente", class: "badge-warning" },
  paid: { label: "Pagado", class: "badge-success" },
  shipped: { label: "Enviado", class: "badge-info" },
  delivered: { label: "Entregado", class: "badge-success" },
  cancelled: { label: "Cancelado", class: "badge-danger" },
  return_requested: { label: "Dev. Solicitada", class: "badge-warning" },
  return_approved: { label: "Dev. Aprobada", class: "badge-warning" },
  return_shipped: { label: "Dev. Enviada", class: "badge-info" },
  return_received: { label: "Dev. Recibida", class: "badge-info" },
  return_completed: { label: "Reembolsado", class: "badge-success" },
  partially_refunded: { label: "Reemb. Parcial", class: "badge-warning" },
};

const ordersTrend = (ordersToday || 0) - (ordersYesterday || 0);

const isOrderUrgent = (order: any) => {
  if (!['pending', 'paid'].includes(order.status)) return false;
  const orderDate = new Date(order.created_at);
  const twoDaysAgo = new Date();
  twoDaysAgo.setDate(twoDaysAgo.getDate() - 2);
  return orderDate < twoDaysAgo;
};

const salesSparkline = analytics?.sales7Days?.map((d: any) => d.revenue || 0) || [];

// Status distribution labels for doughnut
const statusLabels: Record<string, string> = {
  pending: "Pendiente",
  paid: "Pagado",
  shipped: "Enviado",
  delivered: "Entregado",
  cancelled: "Cancelado",
  return_requested: "Dev. Solicitada",
  return_completed: "Reembolsado",
  partially_refunded: "Reemb. Parcial",
};

const statusColors: Record<string, string> = {
  pending: "rgba(234, 179, 8, 0.8)",
  paid: "rgba(34, 197, 94, 0.8)",
  shipped: "rgba(59, 130, 246, 0.8)",
  delivered: "rgba(22, 163, 74, 0.8)",
  cancelled: "rgba(239, 68, 68, 0.8)",
  return_requested: "rgba(249, 115, 22, 0.8)",
  return_completed: "rgba(168, 85, 247, 0.8)",
  partially_refunded: "rgba(236, 72, 153, 0.8)",
};

// Build doughnut data from status distribution (only paid, cancelled, refunded)
const orderStatuses = extendedMetrics?.orderStatusDistribution || {};
const doughnutKeys = ["paid", "cancelled", "return_completed"].filter(k => (orderStatuses[k] || 0) > 0);
const doughnutLabels = doughnutKeys.map(s => statusLabels[s] || s);
const doughnutData = doughnutKeys.map(s => orderStatuses[s] as number);
const doughnutColors = doughnutKeys.map(s => statusColors[s] || "rgba(161, 161, 170, 0.8)");

// Revenue by category doughnut
const catLabels = extendedMetrics?.revenueByCategory?.map((c: any) => c.name) || [];
const catData = extendedMetrics?.revenueByCategory?.map((c: any) => c.revenue) || [];

// Contextual quick actions
const urgentOrders = recentOrders?.filter((o: any) => isOrderUrgent(o)) || [];
const pendingReturnsCount = extendedMetrics?.returns?.pending || 0;
const outOfStockCount = lowStockVariants?.filter((v: any) => v.stock === 0).length || 0;
---

<AdminLayout title="Dashboard">
  <div class="space-y-6">
    {/* ===== HEADER WITH REFRESH ===== */}
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-2xl font-bold text-foreground">Dashboard</h1>
        <p class="text-sm text-muted-foreground">Resumen operativo de tu tienda</p>
      </div>
      <DashboardRefreshButton client:load renderTime={renderTime} />
    </div>

    {/* ===== HERO KPI CARDS (4-col) ===== */}
    {analytics && (
      <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
        {/* Ventas del Mes */}
        <KPICard
          client:load
          title="Ventas del Mes"
          value={formatPrice(analytics.monthlyRevenue.total)}
          trend={analytics.monthlyRevenue.trend}
          trendLabel="vs mes anterior"
          subtitle={`${analytics.monthlyRevenue.orderCount} pedido${analytics.monthlyRevenue.orderCount !== 1 ? "s" : ""}`}
          colorClass="text-green-600 dark:text-green-400"
          iconName="money"
          sparklineData={salesSparkline}
          href="/admin/pedidos"
        />

        {/* Pedidos Hoy */}
        <KPICard
          client:load
          title="Pedidos Hoy"
          value={ordersToday || 0}
          trend={ordersTrend}
          trendLabel="vs ayer"
          subtitle="recibidos hoy"
          colorClass="text-primary"
          iconName="orders"
          href="/admin/pedidos"
        />

        {/* AOV */}
        <KPICard
          client:load
          title="Ticket Medio"
          value={extendedMetrics ? formatPrice(extendedMetrics.aov) : "—"}
          subtitle="valor medio por pedido"
          colorClass="text-blue-600 dark:text-blue-400"
          iconName="chart"
        />

        {/* Pendientes */}
        <KPICard
          client:load
          title="Por Procesar"
          value={analytics.pendingOrders.total}
          subtitle={analytics.pendingOrders.total === 0 ? "¡Todo al día!" : `${analytics.pendingOrders.paid} listos para enviar`}
          colorClass="text-amber-600 dark:text-amber-400"
          iconName="clock"
          href="/admin/pedidos?status=paid"
          urgent={analytics.pendingOrders.total > 5}
        />
      </div>
    )}

    {/* ===== CHARTS SECTION (2/3 + 1/3) ===== */}
    {analytics && (
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        {/* Sales Chart — 2 cols */}
        <div class="lg:col-span-2 admin-card">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h2 class="font-heading text-lg text-foreground">Ventas de la Semana</h2>
              <p class="text-sm text-muted-foreground">Ingresos diarios + tendencia</p>
            </div>
            {analytics.bestSelling && (
              <div class="hidden sm:flex items-center gap-2 text-sm text-muted-foreground">
                <Star className="w-4 h-4 text-primary" />
                <span>Top: <a href={`/admin/productos/${analytics.bestSelling.product.id}`} class="text-primary hover:underline">{analytics.bestSelling.product.name}</a></span>
              </div>
            )}
          </div>
          <SalesChart client:load data={analytics.sales7Days} showTrend={true} />
        </div>

        {/* Order Status Doughnut — 1 col */}
        <div class="admin-card">
          <h2 class="font-heading text-lg text-foreground mb-1">Pedidos (30 días)</h2>
          <p class="text-sm text-muted-foreground mb-4">Pagados · Cancelados · Reembolsados</p>
          <DoughnutChart
            client:load
            labels={doughnutLabels}
            data={doughnutData}
            colors={doughnutColors}
            height={280}
          />
        </div>
      </div>
    )}

    {/* ===== OPERATIONAL METRICS ROW ===== */}
    {extendedMetrics && (
      <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
        {/* Returns */}
        <a href="/admin/devoluciones" class="stat-card group cursor-pointer">
          <div>
            <p class="stat-label">Devoluciones</p>
            <p class={`stat-value ${extendedMetrics.returns.pending > 0 ? 'text-amber-600 dark:text-amber-400' : 'text-foreground'}`}>
              {extendedMetrics.returns.pending}
              <span class="text-sm font-normal text-muted-foreground ml-1">pend.</span>
            </p>
            <p class="text-xs text-muted-foreground mt-1">
              Tasa: {extendedMetrics.returns.rate}%
            </p>
          </div>
          <div class="stat-icon bg-amber-500/10 group-hover:bg-amber-500/20 transition-colors">
            <RotateCcw className="w-7 h-7 text-amber-500" />
          </div>
        </a>

        {/* Coupons */}
        <a href="/admin/cupones" class="stat-card group cursor-pointer">
          <div>
            <p class="stat-label">Cupones Activos</p>
            <p class="stat-value text-purple-600 dark:text-purple-400">
              {extendedMetrics.coupons.activeCount}
            </p>
            <p class="text-xs text-muted-foreground mt-1">
              {extendedMetrics.coupons.usagesThisMonth} usos este mes
            </p>
          </div>
          <div class="stat-icon bg-purple-500/10 group-hover:bg-purple-500/20 transition-colors">
            <Ticket className="w-7 h-7 text-purple-600 dark:text-purple-400" />
          </div>
        </a>

        {/* Shipments in Transit */}
        <a href="/admin/pedidos?status=shipped" class="stat-card group cursor-pointer">
          <div>
            <p class="stat-label">En Tránsito</p>
            <p class="stat-value text-blue-600 dark:text-blue-400">
              {extendedMetrics.shipmentsInTransit}
            </p>
            <p class="text-xs text-muted-foreground mt-1">envíos pendientes</p>
          </div>
          <div class="stat-icon bg-blue-500/10 group-hover:bg-blue-500/20 transition-colors">
            <Truck className="w-7 h-7 text-blue-600 dark:text-blue-400" />
          </div>
        </a>

        {/* Active Promotions */}
        <a href="/admin/promociones" class="stat-card group cursor-pointer">
          <div>
            <p class="stat-label">Promociones Activas</p>
            <p class="stat-value text-pink-600 dark:text-pink-400">
              {extendedMetrics.activePromotions}
            </p>
            <p class="text-xs text-muted-foreground mt-1">en vigor ahora</p>
          </div>
          <div class="stat-icon bg-pink-500/10 group-hover:bg-pink-500/20 transition-colors">
            <Tag className="w-7 h-7 text-pink-600 dark:text-pink-400" />
          </div>
        </a>
      </div>
    )}

    {/* ===== THREE COLUMN WIDGETS ===== */}
    <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
      {/* Recent Orders */}
      <div class="admin-card">
        <div class="flex items-center justify-between mb-4">
          <h2 class="font-heading text-lg text-foreground">Pedidos Recientes</h2>
          <a href="/admin/pedidos" class="text-sm text-primary hover:underline flex items-center gap-1">
            Ver todos <ChevronRight className="w-4 h-4" />
          </a>
        </div>
        {recentOrders && recentOrders.length > 0 ? (
          <div class="space-y-2">
            {recentOrders.map((order: any) => {
              const urgent = isOrderUrgent(order);
              return (
                <a
                  href={`/admin/pedidos/${order.id}`}
                  class={`flex items-center justify-between p-3 rounded-lg bg-muted/30 hover:bg-muted/50 transition-colors border border-transparent hover:border-border group ${urgent ? 'border-l-2 border-l-amber-500 bg-amber-500/5' : ''}`}
                >
                  <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-2">
                      {urgent && <span class="w-2 h-2 rounded-full bg-amber-500 animate-pulse" title="Urgente" />}
                      <p class="text-sm font-medium text-foreground group-hover:text-primary transition-colors truncate">
                        {order.customer_name}
                      </p>
                    </div>
                    <div class="flex items-center gap-2 mt-0.5">
                      <span class={`badge text-[10px] ${statusConfig[order.status]?.class || 'badge-muted'}`}>
                        {statusConfig[order.status]?.label || order.status}
                      </span>
                      <span class="text-[10px] text-muted-foreground">{formatDate(order.created_at)}</span>
                    </div>
                  </div>
                  <span class="text-sm font-medium tabular-nums ml-2">{formatPrice(order.total_amount)}</span>
                </a>
              );
            })}
          </div>
        ) : (
          <div class="text-center py-8 text-muted-foreground">
            <ShoppingBag className="w-10 h-10 mx-auto mb-2 opacity-30" />
            <p class="text-sm">No hay pedidos todavía</p>
          </div>
        )}
      </div>

      {/* Low Stock Alert */}
      <div class="admin-card">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <h2 class="font-heading text-lg text-foreground">Stock Bajo</h2>
            {lowStockVariants && lowStockVariants.length > 0 && (
              <span class="badge badge-danger">{lowStockVariants.length}</span>
            )}
          </div>
          <a href="/admin/inventario" class="text-sm text-primary hover:underline flex items-center gap-1">
            Ver inventario <ChevronRight className="w-4 h-4" />
          </a>
        </div>
        {lowStockVariants && lowStockVariants.length > 0 ? (
          <div class="space-y-2">
            {lowStockVariants.map((variant: any) => (
              <div class="flex items-center justify-between p-2.5 rounded-lg bg-muted/30 hover:bg-muted/50 transition-colors border border-transparent hover:border-border group">
                <div class="flex-1 min-w-0">
                  <a href={`/admin/productos/${variant.product?.id}`} class="text-sm font-medium text-foreground hover:text-primary transition-colors truncate block">
                    {variant.product?.name}
                  </a>
                  <p class="text-xs text-muted-foreground">Talla: {variant.size}</p>
                </div>
                <InlineStockEditor
                  client:load
                  variantId={variant.id}
                  productId={variant.product?.id}
                  productName={variant.product?.name}
                  size={variant.size}
                  currentStock={variant.stock}
                  threshold={lowStockThreshold}
                />
              </div>
            ))}
          </div>
        ) : (
          <div class="text-center py-8 text-muted-foreground">
            <CheckCircle className="w-10 h-10 mx-auto mb-2 text-green-400 opacity-50" />
            <p class="text-sm">Todo el stock está bien</p>
          </div>
        )}
      </div>

      {/* Returns Widget */}
      <div class="admin-card">
        <div class="flex items-center justify-between mb-4">
          <h2 class="font-heading text-lg text-foreground">Devoluciones</h2>
          <a href="/admin/devoluciones" class="text-sm text-primary hover:underline flex items-center gap-1">
            Ver todas <ChevronRight className="w-4 h-4" />
          </a>
        </div>
        <ReturnsWidget
          client:load
          returns={recentReturns || []}
          pendingCount={extendedMetrics?.returns?.pending || 0}
          totalRefunded={extendedMetrics?.returns?.totalRefunded || 0}
          returnRate={extendedMetrics?.returns?.rate || 0}
        />
      </div>
    </div>

    {/* ===== REVENUE BY CATEGORY (when data available) ===== */}
    {catLabels.length > 0 && (
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div class="admin-card">
          <h2 class="font-heading text-lg text-foreground mb-1">Revenue por Categoría</h2>
          <p class="text-sm text-muted-foreground mb-4">Ingresos del mes por tipo de producto</p>
          <DoughnutChart
            client:load
            labels={catLabels}
            data={catData}
            height={260}
            isCurrency={true}
          />
        </div>

        {/* Category breakdown list */}
        <div class="admin-card">
          <h2 class="font-heading text-lg text-foreground mb-1">Desglose por Categoría</h2>
          <p class="text-sm text-muted-foreground mb-4">Ranking de categorías por ingresos</p>
          <div class="space-y-3">
            {extendedMetrics?.revenueByCategory?.map((cat: any) => {
              const maxRevenue = extendedMetrics.revenueByCategory[0]?.revenue || 1;
              const pct = Math.round((cat.revenue / maxRevenue) * 100);
              return (
                <div class="space-y-1">
                  <div class="flex items-center justify-between text-sm">
                    <span class="font-medium text-foreground">{cat.name}</span>
                    <span class="tabular-nums text-muted-foreground">{formatPrice(cat.revenue)}</span>
                  </div>
                  <div class="h-2 bg-muted rounded-full overflow-hidden">
                    <div
                      class="h-full rounded-full bg-primary/70 transition-all"
                      style={`width: ${pct}%`}
                    />
                  </div>
                </div>
              );
            })}
            {(!extendedMetrics?.revenueByCategory || extendedMetrics.revenueByCategory.length === 0) && (
              <p class="text-sm text-muted-foreground text-center py-4">No hay datos de ventas por categoría</p>
            )}
          </div>
        </div>
      </div>
    )}

    {/* ===== CONTEXTUAL QUICK ACTIONS ===== */}
    <div class="admin-card">
      <h2 class="font-heading text-lg text-foreground mb-4">Acciones</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-3">
        {/* Contextual: urgent orders */}
        {urgentOrders.length > 0 && (
          <a href="/admin/pedidos?status=paid" class="flex items-center gap-3 p-4 rounded-xl bg-amber-500/10 border border-amber-500/20 hover:border-amber-500/40 transition-all group">
            <div class="w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center shrink-0 group-hover:scale-110 transition-transform">
              <AlertTriangle className="w-5 h-5 text-amber-500" />
            </div>
            <div>
              <p class="text-sm font-medium text-foreground">{urgentOrders.length} pedido{urgentOrders.length !== 1 ? 's' : ''} urgente{urgentOrders.length !== 1 ? 's' : ''}</p>
              <p class="text-xs text-muted-foreground">Más de 2 días sin procesar</p>
            </div>
          </a>
        )}

        {/* Contextual: pending returns */}
        {pendingReturnsCount > 0 && (
          <a href="/admin/devoluciones" class="flex items-center gap-3 p-4 rounded-xl bg-orange-500/10 border border-orange-500/20 hover:border-orange-500/40 transition-all group">
            <div class="w-10 h-10 rounded-lg bg-orange-500/20 flex items-center justify-center shrink-0 group-hover:scale-110 transition-transform">
              <RotateCcw className="w-5 h-5 text-orange-500" />
            </div>
            <div>
              <p class="text-sm font-medium text-foreground">Revisar {pendingReturnsCount} devolución{pendingReturnsCount !== 1 ? 'es' : ''}</p>
              <p class="text-xs text-muted-foreground">Pendientes de gestión</p>
            </div>
          </a>
        )}

        {/* Contextual: out of stock */}
        {outOfStockCount > 0 && (
          <a href="/admin/inventario" class="flex items-center gap-3 p-4 rounded-xl bg-red-500/10 border border-red-500/20 hover:border-red-500/40 transition-all group">
            <div class="w-10 h-10 rounded-lg bg-red-500/20 flex items-center justify-center shrink-0 group-hover:scale-110 transition-transform">
              <Package className="w-5 h-5 text-red-500" />
            </div>
            <div>
              <p class="text-sm font-medium text-foreground">{outOfStockCount} producto{outOfStockCount !== 1 ? 's' : ''} agotado{outOfStockCount !== 1 ? 's' : ''}</p>
              <p class="text-xs text-muted-foreground">Stock a 0 unidades</p>
            </div>
          </a>
        )}

        {/* Fixed actions */}
        <a href="/admin/productos/nuevo" class="flex items-center gap-3 p-4 rounded-xl bg-muted/30 border border-border hover:border-primary/40 hover:bg-primary/5 transition-all group">
          <div class="w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center shrink-0 group-hover:scale-110 transition-transform">
            <Plus className="w-5 h-5 text-primary" />
          </div>
          <div>
            <p class="text-sm font-medium text-foreground">Nuevo Producto</p>
            <p class="text-xs text-muted-foreground">Añadir al catálogo</p>
          </div>
        </a>

        <a href="/admin/pedidos" class="flex items-center gap-3 p-4 rounded-xl bg-muted/30 border border-border hover:border-blue-500/40 hover:bg-blue-500/5 transition-all group">
          <div class="w-10 h-10 rounded-lg bg-blue-500/10 flex items-center justify-center shrink-0 group-hover:scale-110 transition-transform">
            <FileText className="w-5 h-5 text-blue-600 dark:text-blue-400" />
          </div>
          <div>
            <p class="text-sm font-medium text-foreground">Ver Pedidos</p>
            <p class="text-xs text-muted-foreground">Gestionar pedidos</p>
          </div>
        </a>

        <a href="/admin/configuracion" class="flex items-center gap-3 p-4 rounded-xl bg-muted/30 border border-border hover:border-green-500/40 hover:bg-green-500/5 transition-all group">
          <div class="w-10 h-10 rounded-lg bg-green-500/10 flex items-center justify-center shrink-0 group-hover:scale-110 transition-transform">
            <Settings className="w-5 h-5 text-green-600 dark:text-green-400" />
          </div>
          <div>
            <p class="text-sm font-medium text-foreground">Configuración</p>
            <p class="text-xs text-muted-foreground">Ajustes de la tienda</p>
          </div>
        </a>

        <a href="/admin/newsletter" class="flex items-center gap-3 p-4 rounded-xl bg-muted/30 border border-border hover:border-amber-500/40 hover:bg-amber-500/5 transition-all group">
          <div class="w-10 h-10 rounded-lg bg-amber-500/10 flex items-center justify-center shrink-0 group-hover:scale-110 transition-transform">
            <Mail className="w-5 h-5 text-amber-600 dark:text-amber-400" />
          </div>
          <div>
            <p class="text-sm font-medium text-foreground">Newsletter</p>
            <p class="text-xs text-muted-foreground">Campañas de email</p>
          </div>
        </a>
      </div>
    </div>
  </div>
</AdminLayout>
