---
import PublicLayout from "@/layouts/PublicLayout.astro";
import { getShippingConfig, getSetting } from "@/lib/settings";
import { formatPrice } from "@/lib/formatters";
import { Truck, Package, RefreshCw, Globe, Clock, AlertTriangle } from "lucide-react";

// Obtener configuración desde la base de datos
const shippingConfig = await getShippingConfig();
const returnWindowDays = await getSetting('returnWindowDays');
---

<PublicLayout
  title="Envíos y Devoluciones - FashionStore"
  description="Información sobre envíos, plazos de entrega y política de devoluciones."
>
  <!-- Breadcrumb -->
  <div class="border-b border-border">
    <div class="container mx-auto px-4 py-3">
      <nav class="text-sm text-muted-foreground">
        <ol class="flex items-center gap-2">
          <li><a href="/" class="hover:text-primary transition-colors">Inicio</a></li>
          <li>/</li>
          <li class="text-foreground">Envíos y Devoluciones</li>
        </ol>
      </nav>
    </div>
  </div>

  <div class="container mx-auto px-4 py-8 md:py-12 max-w-4xl">
    <div class="text-center mb-12">
      <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-primary/10 flex items-center justify-center">
        <Truck className="w-8 h-8 text-primary" />
      </div>
      <h1 class="font-display text-4xl md:text-5xl mb-4">
        Envíos y Devoluciones
      </h1>
      <p class="text-lg text-muted-foreground max-w-xl mx-auto">
        Todo lo que necesitas saber sobre la entrega de tu pedido
      </p>
    </div>

    <div class="space-y-8">
      <!-- Shipping Section -->
      <section class="admin-card">
        <div class="flex items-center gap-3 mb-6">
          <div class="w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center">
            <Package className="w-5 h-5 text-primary" />
          </div>
          <h2 class="font-heading text-2xl">Política de Envíos</h2>
        </div>

        <div class="mb-6">
          <div class="p-5 rounded-xl bg-muted/30 border border-border hover:border-primary/30 transition-colors max-w-md">
            <div class="flex items-center gap-2 mb-3">
              <Truck className="w-5 h-5 text-primary" />
              <h3 class="font-bold">Envío Estándar</h3>
            </div>
            <p class="text-2xl font-display text-primary mb-1">{formatPrice(shippingConfig.shippingCostEuros)}</p>
            <p class="text-sm text-muted-foreground mb-3">
              Gratis en pedidos +{shippingConfig.freeShippingThreshold}€
            </p>
            <div class="flex items-center gap-1 text-sm">
              <Clock className="w-4 h-4 text-muted-foreground" />
              <span>3-5 días laborables</span>
            </div>
          </div>
        </div>

        <div class="text-muted-foreground space-y-3 text-sm">
          <p>
            Los pedidos realizados antes de las 14:00 (hora peninsular) se
            preparan y envían el mismo día laborable. Recibirás un email con
            el número de seguimiento en cuanto tu paquete salga de nuestros
            almacenes.
          </p>
          <p>
            Realizamos envíos a toda España (Península y Baleares). Por el
            momento no realizamos envíos a Canarias, Ceuta y Melilla.
          </p>
        </div>
      </section>

      <!-- Returns Section -->
      <section class="admin-card">
        <div class="flex items-center gap-3 mb-6">
          <div class="w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center">
            <RefreshCw className="w-5 h-5 text-primary" />
          </div>
          <h2 class="font-heading text-2xl">Devoluciones y Cambios</h2>
        </div>

        <div class="bg-primary/5 border border-primary/20 rounded-xl p-6 mb-6 flex flex-col md:flex-row items-center gap-6">
          <div class="text-center md:text-left flex-1">
            <h3 class="font-bold text-xl text-primary mb-2">
              Garantía de Satisfacción
            </h3>
            <p class="text-muted-foreground">
              Tienes {returnWindowDays} días naturales desde la recepción de tu pedido para
              realizar cualquier cambio o devolución de forma totalmente
              gratuita.
            </p>
          </div>
          <a href="/cuenta/pedidos" class="admin-btn-primary whitespace-nowrap">
            Iniciar Devolución
          </a>
        </div>

        <div class="space-y-4 mb-6">
          <h3 class="font-bold text-lg">¿Cómo realizar una devolución?</h3>
          <div class="space-y-3">
            {[
              { step: 1, title: "Solicita la devolución", desc: 'Entra en "Mi Cuenta", selecciona el pedido y los artículos que quieres devolver.' },
              { step: 2, title: "Prepara el paquete", desc: "Guarda los artículos en su embalaje original junto con el albarán de entrega." },
              { step: 3, title: "Entrégalo", desc: "Lleva el paquete al punto de recogida más cercano o espera a que pasen a recogerlo." },
              { step: 4, title: "Reembolso", desc: "Una vez recibamos y revisemos los artículos, te devolveremos el dinero en 5-7 días." },
            ].map(({ step, title, desc }) => (
              <div class="flex gap-4 items-start p-4 rounded-lg bg-muted/30">
                <div class="w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0">
                  <span class="text-sm font-bold text-primary">{step}</span>
                </div>
                <div>
                  <p class="font-medium">{title}</p>
                  <p class="text-sm text-muted-foreground">{desc}</p>
                </div>
              </div>
            ))}
          </div>
        </div>

        <div class="flex items-start gap-3 p-4 rounded-lg bg-yellow-500/10 border border-yellow-500/20">
          <AlertTriangle className="w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5" />
          <div class="text-sm">
            <p class="font-medium text-yellow-600 dark:text-yellow-400">Importante</p>
            <p class="text-yellow-600/80 dark:text-yellow-400/80">
              Los artículos deben estar en perfecto estado, con sus etiquetas originales y sin usar. 
              La ropa interior no admite devolución por motivos de higiene.
            </p>
          </div>
        </div>
      </section>

      <!-- Contact CTA -->
      <div class="text-center py-8">
        <p class="text-muted-foreground mb-4">¿Tienes más preguntas?</p>
        <a href="/contacto" class="admin-btn-secondary inline-flex">
          Contactar con soporte
        </a>
      </div>
    </div>
  </div>
</PublicLayout>
